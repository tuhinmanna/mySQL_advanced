
# üè® Overlapped Bookings

## üìå Problem
Detect overlapping bookings in hotel rooms.  
A booking overlaps if the time intervals intersect


---

## üóÇÔ∏è Input

| booking_id | room_id | start_time          | end_time            |
|------------|---------|---------------------|---------------------|
| 1          | 100     | 2025-01-01 10:00:00 | 2025-01-01 12:00:00 |
| 2          | 100     | 2025-01-01 11:30:00 | 2025-01-01 13:00:00 |
| 3          | 100     | 2025-01-01 12:30:00 | 2025-01-01 14:00:00 |
| 4          | 101     | 2025-01-01 09:00:00 | 2025-01-01 10:00:00 |
| 5          | 101     | 2025-01-01 10:00:00 | 2025-01-01 11:00:00 |
| 6          | 101     | 2025-01-01 11:00:00 | 2025-01-01 12:00:00 |
| 7          | 102     | 2025-01-01 09:00:00 | 2025-01-01 12:00:00 |
| 8          | 102     | 2025-01-01 10:00:00 | 2025-01-01 11:00:00 |
| 9          | 103     | 2025-01-01 13:00:00 | 2025-01-01 15:00:00 |
| 10         | 103     | 2025-01-01 14:00:00 | 2025-01-01 16:00:00 |
| 11         | 103     | 2025-01-01 14:30:00 | 2025-01-01 15:30:00 |
| 12         | 104     | 2025-01-01 09:00:00 | 2025-01-01 11:00:00 |
| 13         | 105     | 2025-01-01 12:00:00 | 2025-01-01 14:00:00 |
| 14         | 105     | 2025-01-01 13:30:00 | 2025-01-01 15:30:00 |
| 15         | 106     | 2025-01-01 09:00:00 | 2025-01-01 11:00:00 |
| 16         | 106     | 2025-01-01 10:30:00 | 2025-01-01 12:00:00 |
| 17         | 106     | 2025-01-01 12:30:00 | 2025-01-01 14:00:00 |

---

## üí° Output (Overlaps Detected)

| booking1 | booking2 | room_id | b1_start            | b1_end              | b2_start            | b2_end              |
|----------|----------|---------|---------------------|---------------------|---------------------|---------------------|
| 1        | 2        | 100     | 2025-01-01 10:00:00 | 2025-01-01 12:00:00 | 2025-01-01 11:30:00 | 2025-01-01 13:00:00 |
| 1        | 3        | 100     | 2025-01-01 10:00:00 | 2025-01-01 12:00:00 | 2025-01-01 12:30:00 | 2025-01-01 14:00:00 |
| 2        | 3        | 100     | 2025-01-01 11:30:00 | 2025-01-01 13:00:00 | 2025-01-01 12:30:00 | 2025-01-01 14:00:00 |
| 7        | 8        | 102     | 2025-01-01 09:00:00 | 2025-01-01 12:00:00 | 2025-01-01 10:00:00 | 2025-01-01 11:00:00 |
| 9        | 10       | 103     | 2025-01-01 13:00:00 | 2025-01-01 15:00:00 | 2025-01-01 14:00:00 | 2025-01-01 16:00:00 |
| 9        | 11       | 103     | 2025-01-01 13:00:00 | 2025-01-01 15:00:00 | 2025-01-01 14:30:00 | 2025-01-01 15:30:00 |
| 10       | 11       | 103     | 2025-01-01 14:00:00 | 2025-01-01 16:00:00 | 2025-01-01 14:30:00 | 2025-01-01 15:30:00 |
| 13       | 14       | 105     | 2025-01-01 12:00:00 | 2025-01-01 14:00:00 | 2025-01-01 13:30:00 | 2025-01-01 15:30:00 |
| 15       | 16       | 106     | 2025-01-01 09:00:00 | 2025-01-01 11:00:00 | 2025-01-01 10:30:00 | 2025-01-01 12:00:00 |

---

## ‚úÖ Key Concepts
- Self-join to compare bookings in the **same room**.  
- Overlap condition: `start1 < end2 AND start2 < end1`.  
- Exclude duplicates with `b1.booking_id < b2.booking_id`.  
